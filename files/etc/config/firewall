
config defaults 'defaults'
	option syn_flood '1'
	option input 'DROP'
	option output 'ACCEPT'
	option forward 'DROP'

config zone 'zone_lan'
	option name 'lan'
	list network 'lan'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'ACCEPT'

config forwarding 'fw_lan_ext'
	option src 'lan'
	option dest 'ext'

config rule
	option name 'Allow-DHCP-Renew'
	option src 'wan'
	option proto 'udp'
	option dest_port '68'
	option target 'ACCEPT'
	option family 'ipv4'

config rule
	option name 'Allow-ICMP-Full'
	option src 'wan'
	option proto 'icmp'
	option target 'ACCEPT'

config rule
	option name 'Allow-DHCPv6'
	option src 'wan'
	option proto 'udp'
	option dest_port '546'
	option family 'ipv6'
	option target 'ACCEPT'

config zone 'docker'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'ACCEPT'
	option name 'docker'
	list network 'docker'

config rule
	option enabled '1'
	option target 'ACCEPT'
	option src 'wan'
	option proto 'tcp'
	option dest_port '80 443'
	option name 'Allow-TCP-wan'

config zone 'zone_wan'
	option name 'wan'
	option input 'DROP'
	option output 'ACCEPT'
	option forward 'DROP'
	list network 'wan4'
	list network 'wan6'

config ipset 'vpn4_a'
	option name 'vpn4_a'
	option family 'ipv4'
	list match 'dst_net'
	option loadfile '/etc/nftsets/vpn4_a.txt'

config ipset 'vpn6_a'
	option name 'vpn6_a'
	option family 'ipv6'
	list match 'dst_net'
	option loadfile '/etc/nftsets/vpn6_a.txt'

config rule 'mark4_lan_a'
	option name 'mark4_lan_a'
	option src 'lan'
	option dest '*'
	option ipset 'vpn4_a'
	option set_mark '0x100'
	option target 'MARK'
	list proto 'all'

config rule 'mark6_lan_a'
	option name 'mark6_lan_a'
	option src 'lan'
	option dest '*'
	option ipset 'vpn6_a'
	option set_mark '0x100'
	option target 'MARK'
	list proto 'all'

config rule 'mark4_int_a'
	option name 'mark4_int_a'
	option dest 'ext'
	option ipset 'vpn4_a'
	option set_mark '0x100'
	option target 'MARK'
	list proto 'all'

config rule 'mark6_int_a'
	option name 'mark6_int_a'
	option dest 'ext'
	option ipset 'vpn6_m'
	option set_mark '0x100'
	option target 'MARK'
	list proto 'all'
